---
layout: post
title:  "MSE & R2-square"
date:   2020-01-20 14:52:13
categories: Machine_Learning
---



# 10.5 선형 회귀 모델의 성능 평가

### 잔차 그래프 (residual plot)

회귀 모델을 진단할 때 자주 사용되는 그래프 도구로 비선형성과 이상치를 감지하고 오차가 랜덤하게 분포되어 있는지를 확인하는 데 도움을 준다.

잔차 그래프는 예측 값에서 타깃 값을 빼기 때문에 예측이 완벽하다면 잔차는 정확히 0이 되겠지만 현실적으로 그런일은 일어나지 않는다. 좋은 회귀 모델일수록 오차가 랜덤하게 분포되고, 잔차는 중앙선 주변으로 랜덤하게 흩어져야 한다. 다시말해 잔차 그래프에 어떠한 패턴이 있다면 어떤 특성에서 정보를 얻어내지 못하고 잔차로 새어 나갔다고 말한다.



### 평균 제곱 오차 (Mean Squared Error, MSE)

이 값은 제곱 오차 합(SSE)의 평균이다.

> SSE는 선형 회귀 모델을 훈련하기 위해 최소화 해야 하는 값이다.

MSE는 그리드 서치와 교차 검증에서 매개변수를 튜닝하거나 여러 다른 회귀 모델을 비교할 때 유용하다. 이는 SSE를 샘플의 개수로 나누어 계산할 수 있다.

*사용을 위해서는 sklearn.metrics의 mean_squared_error를 import한다.* 

훈련 세트의 MSE와 테스트 세트의 MSE를 출력하여 비교할 수 있는데, 만일 테스트 세트의 MSE가 훈련 세트의 MSE보다 훨씬 크다면 모델이 훈련 세트에 과대적합되었다는 신호이다.



### 결정 계수 (coefficient of determination, $$R^2$$)

결정 계수는 모델 성능을 잘 해석하기 위해 만든 MSE의 표준화 버전으로 생각할 수 있다. 쉽게 말하면 전체 표본에서 잔차로 빠지지 않은, 즉 모델이 무시하지 않고 뽑아낸 비율이라고 할 수 있는데, 이는 다음과 같은 식으로 정리할 수 있다.
$$
R^2 = 1- {SSE \over SST}\\
$$
여기서 SSE는 제곱 오차 합이고, SST는 전체 제곱합이다.

> SST = SSR + SSE

훈련 세트에서 $$R^2$$은 0과 1 사이의 값을 가지게 되고, $$R^2 = 1$$이면 MSE는 0이고 모델이 데이터를 완벽하게 학습한 것이다.

*사용을 위해서는 sklearn.metrics의 r2_score를 import 한다.*

